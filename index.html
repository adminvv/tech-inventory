<!DOCTYPE html>
<!-- saved from url=(0055)file:///Users/rkeys/Downloads/technology-inventory.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Van Vleck ISD - Technology Inventory</title>
  <script src="./Van Vleck ISD - Technology Inventory_files/saved_resource"></script>
  <script src="./Van Vleck ISD - Technology Inventory_files/html5-qrcode.min.js"></script>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.relative{position:relative}.right-4{right:1rem}.top-4{top:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-6{margin-bottom:1.5rem}.mr-3{margin-right:0.75rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-8{margin-bottom:2rem}.ml-2{margin-left:0.5rem}.flex{display:flex}.w-full{width:100%}.min-w-full{min-width:100%}.max-w-7xl{max-width:80rem}.flex-1{flex:1 1 0%}.list-inside{list-style-position:inside}.list-decimal{list-style-type:decimal}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.divide-y > :not([hidden]) ~ :not([hidden]){--tw-divide-y-reverse:0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.divide-gray-200 > :not([hidden]) ~ :not([hidden]){--tw-divide-opacity:1;border-color:rgb(229 231 235 / var(--tw-divide-opacity, 1))}.overflow-x-auto{overflow-x:auto}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity:1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.p-4{padding:1rem}.p-6{padding:1.5rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.pl-10{padding-left:2.5rem}.pr-4{padding-right:1rem}.text-left{text-align:left}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:text-blue-900:hover{--tw-text-opacity:1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.hover\:text-red-900:hover{--tw-text-opacity:1;color:rgb(127 29 29 / var(--tw-text-opacity, 1))}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}@media (min-width: 768px){.md\:flex-row{flex-direction:row}}</style></head>
<body class="bg-gray-50">
  <div id="app">
        <div class="max-w-7xl mx-auto p-4">
          <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <!-- Header -->
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-6">
              <div class="flex items-center gap-3">
                <svg class="text-blue-600" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="3" y1="9" x2="21" y2="9"></line>
                  <line x1="9" y1="21" x2="9" y2="9"></line>
                </svg>
                <h1 class="text-3xl font-bold text-gray-800">Technology Inventory</h1>
              </div>
              
              <div class="flex gap-2">
                <button onclick="changeView(&#39;inventory&#39;)" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700">
                  Inventory
                </button>
                <button onclick="loadFromSheets()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                  Load from Sheets
                </button>
                <button onclick="changeView(&#39;settings&#39;)" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                  Settings
                </button>
              </div>
            </div>

            
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Settings</h2>
        
        <div class="mb-8">
          <h3 class="text-lg font-semibold text-gray-700 mb-3">Google Sheets Integration</h3>
          <p class="text-sm text-gray-600 mb-3">Enter your Google Apps Script Web App URL to sync data with Google Sheets.</p>
          <input type="text" value="https://script.google.com/macros/s/AKfycbzENzJmuh6QD4V6BfC9GYndSN5FT5sLSGz7dWo1blN_4rFHogeQA8BMXZ6lJmAbNT8WYw/exec" oninput="state.sheetsUrl = this.value" placeholder="https://script.google.com/macros/s/..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 mb-3">
          <button onclick="saveSettings()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
            Save Settings
          </button>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="text-lg font-semibold text-gray-700 mb-2">📋 Managing Sites &amp; Rooms</h3>
          <p class="text-sm text-gray-700 mb-2"><strong>Sites and Rooms are managed in Google Sheets!</strong></p>
          <ol class="text-sm text-gray-600 list-decimal list-inside space-y-1 ml-2">
            <li>Open your Google Sheet (the one connected to this app)</li>
            <li>Go to the "Sites" tab to manage school sites</li>
            <li>Go to the "Rooms" tab to manage room numbers</li>
            <li>Add or delete rows as needed</li>
            <li>Come back here and click "Load from Sheets" button</li>
          </ol>
        </div>
      
          </div>
        </div>

        
        
      </div>

  <script>
    // State management
    let state = {
      items: JSON.parse(localStorage.getItem('techInventory') || '[]'),
      sites: [],
      rooms: [],
      sheetsUrl: localStorage.getItem('sheetsUrl') || '',
      searchTerm: '',
      currentView: 'inventory',
      showAddModal: false,
      showScanner: false,
      showClassroomsOnly: true,
      editingItem: null,
      formData: {
        name: '',
        barcode: '',
        category: 'Desktop',
        site: '',
        room: '',
        status: 'Available',
        assignedTo: '',
        purchaseDate: ''
      }
    };

    const categories = ['Desktop', 'TV', 'Laptop', 'Tablet', 'Printer', 'Switch', 'Server', 'UPS', 'Other'];
    const statuses = ['Available', 'In Use', 'In Repair', 'Retired'];

    // Utility functions
    function isClassroom(roomNumber) {
      const room = roomNumber.includes(' - ') ? roomNumber.split(' - ')[1] : roomNumber;
      const excludeKeywords = [
        'RESTROOM', 'RR', 'STORAGE', 'CUSTODIAL', 'MECHANICAL', 'ELECTRICAL',
        'IDF', 'MDF', 'CORRIDOR', 'OFFICE', 'CLINIC', 'KITCHEN', 'VESTIBULE',
        'STAIR', 'ELEVATOR', 'FIRE RISER', 'BOILER', 'RECEPTION', 'ATTENDANCE',
        'WORKROOM', 'ISS', 'RECORDS', 'SERVICE YARD', 'ENTRY', 'MAIN STREET',
        'CIRCULATION', 'LOUNGE', 'CHAIR STORAGE', 'GYM STORAGE', 'LOCKERS'
      ];
      const roomUpper = room.toUpperCase();
      return !excludeKeywords.some(keyword => roomUpper.includes(keyword));
    }

    function getFilteredRooms() {
      if (!state.formData.site) return [];
      let filteredRooms = state.rooms.filter(room => room.startsWith(state.formData.site + ' - '));
      if (state.showClassroomsOnly) {
        filteredRooms = filteredRooms.filter(room => isClassroom(room));
      }
      return filteredRooms.map(room => room.replace(state.formData.site + ' - ', ''));
    }

    function formatDateTime(isoString) {
      if (!isoString) return 'N/A';
      const date = new Date(isoString);
      return date.toLocaleString('en-US', {
        month: 'short',
        day: 'numeric',
        year: 'numeric',
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }

    function showMessage(message, type = 'success') {
      const msgDiv = document.createElement('div');
      msgDiv.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg ${
        type === 'success' ? 'bg-green-100 text-green-800' :
        type === 'error' ? 'bg-red-100 text-red-800' :
        'bg-blue-100 text-blue-800'
      }`;
      msgDiv.textContent = message;
      document.body.appendChild(msgDiv);
      setTimeout(() => msgDiv.remove(), 3000);
    }

    // API functions
    async function syncToSheets() {
      if (!state.sheetsUrl) {
        showMessage('Please configure Google Sheets URL in Settings first', 'error');
        return;
      }

      try {
        await fetch(state.sheetsUrl, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'sync',
            items: state.items,
            sites: state.sites,
            rooms: state.rooms
          })
        });
        showMessage('Auto-synced to Google Sheets successfully!');
      } catch (error) {
        console.error('Sync error:', error);
        showMessage('Auto-sync failed. Will retry on next change.', 'error');
      }
    }

    async function loadFromSheets() {
      if (!state.sheetsUrl) {
        alert('Please configure Google Sheets URL in Settings first');
        return;
      }

      try {
        const response = await fetch(`${state.sheetsUrl}?action=load&timestamp=${Date.now()}`);
        const data = await response.json();
        
        if (data.items) state.items = data.items;
        if (data.sites) state.sites = data.sites;
        if (data.rooms) state.rooms = data.rooms;
        
        localStorage.setItem('techInventory', JSON.stringify(state.items));
        showMessage('Data loaded from Google Sheets successfully!');
        render();
      } catch (error) {
        console.error('Load error:', error);
        showMessage('Error loading from Google Sheets. Using local data.', 'error');
      }
    }

    // Item operations
    function addItem() {
      if (!state.formData.name || !state.formData.barcode) {
        alert('Please fill in name and barcode');
        return;
      }

      const now = new Date().toISOString();
      const location = `${state.formData.site} - ${state.formData.room}`;
      
      const newItem = {
        id: Date.now(),
        ...state.formData,
        location: location,
        dateAdded: now,
        lastModified: now
      };

      state.items.push(newItem);
      localStorage.setItem('techInventory', JSON.stringify(state.items));
      resetForm();
      state.showAddModal = false;
      syncToSheets();
      render();
    }

    function editItem() {
      if (!state.formData.name || !state.formData.barcode) {
        alert('Please fill in name and barcode');
        return;
      }

      const now = new Date().toISOString();
      const location = `${state.formData.site} - ${state.formData.room}`;
      
      state.items = state.items.map(item => 
        item.id === state.editingItem.id ? {
          ...item,
          ...state.formData,
          location: location,
          lastModified: now,
          dateAdded: item.dateAdded
        } : item
      );

      localStorage.setItem('techInventory', JSON.stringify(state.items));
      resetForm();
      state.editingItem = null;
      state.showAddModal = false;
      syncToSheets();
      render();
    }

    function deleteItem(id) {
      if (confirm('Are you sure you want to delete this item?')) {
        state.items = state.items.filter(item => item.id !== id);
        localStorage.setItem('techInventory', JSON.stringify(state.items));
        syncToSheets();
        render();
      }
    }

    function openEditModal(item) {
      const locationParts = item.location ? item.location.split(' - ') : ['', ''];
      const site = locationParts[0] || '';
      const room = locationParts.slice(1).join(' - ') || '';
      
      state.editingItem = item;
      state.formData = {
        name: item.name,
        barcode: item.barcode,
        category: item.category,
        site: site,
        room: room,
        status: item.status,
        assignedTo: item.assignedTo || '',
        purchaseDate: item.purchaseDate || ''
      };
      state.showAddModal = true;
      render();
    }

    function resetForm() {
      state.formData = {
        name: '',
        barcode: '',
        category: 'Desktop',
        site: '',
        room: '',
        status: 'Available',
        assignedTo: '',
        purchaseDate: ''
      };
    }

    function saveSettings() {
      localStorage.setItem('sheetsUrl', state.sheetsUrl);
      showMessage('Settings saved successfully!');
    }

    // Render functions
    function render() {
      const app = document.getElementById('app');
      const filteredItems = state.items.filter(item =>
        item.name.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
        item.barcode.toLowerCase().includes(state.searchTerm.toLowerCase()) ||
        item.location.toLowerCase().includes(state.searchTerm.toLowerCase())
      );

      app.innerHTML = `
        <div class="max-w-7xl mx-auto p-4">
          <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <!-- Header -->
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-6">
              <div class="flex items-center gap-3">
                <svg class="text-blue-600" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="3" y1="9" x2="21" y2="9"></line>
                  <line x1="9" y1="21" x2="9" y2="9"></line>
                </svg>
                <h1 class="text-3xl font-bold text-gray-800">Technology Inventory</h1>
              </div>
              
              <div class="flex gap-2">
                <button onclick="changeView('inventory')" 
                  class="px-4 py-2 rounded-lg ${state.currentView === 'inventory' ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700'}">
                  Inventory
                </button>
                <button onclick="loadFromSheets()" 
                  class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                  Load from Sheets
                </button>
                <button onclick="changeView('settings')" 
                  class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700">
                  Settings
                </button>
              </div>
            </div>

            ${state.currentView === 'inventory' ? renderInventoryView(filteredItems) : renderSettingsView()}
          </div>
        </div>

        ${state.showScanner ? renderScannerModal() : ''}
        ${state.showAddModal ? renderAddModal() : ''}
      `;
    }

    function renderInventoryView(filteredItems) {
      return `
        <!-- Search and Actions -->
        <div class="flex flex-col md:flex-row gap-4 mb-6">
          <div class="flex-1 relative">
            <input type="text" 
              placeholder="Search by name, barcode, or location..." 
              value="${state.searchTerm}"
              oninput="state.searchTerm = this.value; render();"
              class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          <button onclick="state.showScanner = true; render();" 
            class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
            Scan Barcode
          </button>
          <button onclick="resetForm(); state.editingItem = null; state.showAddModal = true; render();" 
            class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
            Add Item
          </button>
        </div>

        <!-- Inventory Table -->
        <div class="overflow-x-auto">
          <table class="min-w-full">
            <thead class="bg-gray-100">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Barcode</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Category</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Location</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Assigned To</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date Added</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Last Modified</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              ${filteredItems.map(item => `
                <tr class="hover:bg-gray-50">
                  <td class="px-4 py-4 text-sm font-medium text-gray-900">${item.name}</td>
                  <td class="px-4 py-4 text-sm text-gray-900">${item.barcode}</td>
                  <td class="px-4 py-4 text-sm text-gray-900">${item.category}</td>
                  <td class="px-4 py-4 text-sm text-gray-900">${item.location}</td>
                  <td class="px-4 py-4">
                    <span class="px-2 text-xs font-semibold rounded-full ${
                      item.status === 'Available' ? 'bg-green-100 text-green-800' :
                      item.status === 'In Use' ? 'bg-blue-100 text-blue-800' :
                      item.status === 'In Repair' ? 'bg-yellow-100 text-yellow-800' :
                      'bg-gray-100 text-gray-800'
                    }">
                      ${item.status}
                    </span>
                  </td>
                  <td class="px-4 py-4 text-sm text-gray-900">${item.assignedTo || '-'}</td>
                  <td class="px-4 py-4 text-sm text-gray-500">${formatDateTime(item.dateAdded)}</td>
                  <td class="px-4 py-4 text-sm text-gray-500">${formatDateTime(item.lastModified)}</td>
                  <td class="px-4 py-4 text-sm">
                    <button onclick='openEditModal(${JSON.stringify(item).replace(/'/g, "&apos;")})' 
                      class="text-blue-600 hover:text-blue-900 mr-3">Edit</button>
                    <button onclick="deleteItem(${item.id})" 
                      class="text-red-600 hover:text-red-900">Delete</button>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>

        ${filteredItems.length === 0 ? '<div class="text-center py-12 text-gray-500 text-lg">No items found</div>' : ''}
      `;
    }

    function renderSettingsView() {
      return `
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Settings</h2>
        
        <div class="mb-8">
          <h3 class="text-lg font-semibold text-gray-700 mb-3">Google Sheets Integration</h3>
          <p class="text-sm text-gray-600 mb-3">Enter your Google Apps Script Web App URL to sync data with Google Sheets.</p>
          <input type="text" 
            value="${state.sheetsUrl}"
            oninput="state.sheetsUrl = this.value"
            placeholder="https://script.google.com/macros/s/..."
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 mb-3">
          <button onclick="saveSettings()" 
            class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
            Save Settings
          </button>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <h3 class="text-lg font-semibold text-gray-700 mb-2">📋 Managing Sites & Rooms</h3>
          <p class="text-sm text-gray-700 mb-2"><strong>Sites and Rooms are managed in Google Sheets!</strong></p>
          <ol class="text-sm text-gray-600 list-decimal list-inside space-y-1 ml-2">
            <li>Open your Google Sheet (the one connected to this app)</li>
            <li>Go to the "Sites" tab to manage school sites</li>
            <li>Go to the "Rooms" tab to manage room numbers</li>
            <li>Add or delete rows as needed</li>
            <li>Come back here and click "Load from Sheets" button</li>
          </ol>
        </div>
      `;
    }

    function renderScannerModal() {
      return `
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div class="bg-white p-6 rounded-lg max-w-md w-full">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">Scan Barcode</h3>
              <button onclick="state.showScanner = false; render();" class="text-gray-500 hover:text-gray-700">✕</button>
            </div>
            <p class="text-sm text-gray-600 mb-3">Enter barcode manually:</p>
            <input type="text" id="barcodeInput" 
              placeholder="Enter barcode" 
              class="w-full px-3 py-2 border border-gray-300 rounded-lg mb-3">
            <button onclick="
              state.formData.barcode = document.getElementById('barcodeInput').value;
              state.showScanner = false;
              state.showAddModal = true;
              render();
            " class="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
              Use This Barcode
            </button>
          </div>
        </div>
      `;
    }

    function renderAddModal() {
      const filteredRooms = getFilteredRooms();
      
      return `
        <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto">
          <div class="bg-white p-6 rounded-lg max-w-2xl w-full m-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-bold">${state.editingItem ? 'Edit Item' : 'Add New Item'}</h3>
              <button onclick="state.showAddModal = false; state.editingItem = null; resetForm(); render();" 
                class="text-gray-500 hover:text-gray-700">✕</button>
            </div>

            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Item Name</label>
                <input type="text" value="${state.formData.name}" 
                  oninput="state.formData.name = this.value"
                  placeholder="e.g., Dell Latitude 5420"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Barcode</label>
                <input type="text" value="${state.formData.barcode}" 
                  oninput="state.formData.barcode = this.value"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                <select onchange="state.formData.category = this.value" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                  ${categories.map(cat => 
                    `<option value="${cat}" ${state.formData.category === cat ? 'selected' : ''}>${cat}</option>`
                  ).join('')}
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Site</label>
                <select onchange="state.formData.site = this.value; state.formData.room = ''; render();" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                  <option value="">Select Site</option>
                  ${state.sites.map(site => 
                    `<option value="${site}" ${state.formData.site === site ? 'selected' : ''}>${site}</option>`
                  ).join('')}
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Room</label>
                <div class="flex items-center gap-2 mb-2 bg-blue-50 p-2 rounded">
                  <input type="checkbox" id="classroomFilter" 
                    ${state.showClassroomsOnly ? 'checked' : ''}
                    onchange="state.showClassroomsOnly = this.checked; render();">
                  <label for="classroomFilter" class="text-sm text-gray-700">
                    Show classrooms only (hide storage, mechanical, restrooms, etc.)
                  </label>
                </div>
                <select onchange="state.formData.room = this.value" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg" 
                  ${!state.formData.site ? 'disabled' : ''}>
                  <option value="">${state.formData.site ? 'Select Room' : 'Select Site First'}</option>
                  ${filteredRooms.map(room => 
                    `<option value="${room}" ${state.formData.room === room ? 'selected' : ''}>${room}</option>`
                  ).join('')}
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                <select onchange="state.formData.status = this.value" 
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                  ${statuses.map(status => 
                    `<option value="${status}" ${state.formData.status === status ? 'selected' : ''}>${status}</option>`
                  ).join('')}
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Assigned To (Optional)</label>
                <input type="text" value="${state.formData.assignedTo}" 
                  oninput="state.formData.assignedTo = this.value"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
              </div>

              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Purchase Date (Optional)</label>
                <input type="date" value="${state.formData.purchaseDate}" 
                  oninput="state.formData.purchaseDate = this.value"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg">
              </div>

              <div class="flex gap-3">
                <button onclick="state.showAddModal = false; state.editingItem = null; resetForm(); render();" 
                  class="flex-1 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400">
                  Cancel
                </button>
                <button onclick="${state.editingItem ? 'editItem()' : 'addItem()'}" 
                  class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                  ${state.editingItem ? 'Save Changes' : 'Add Item'}
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function changeView(view) {
      state.currentView = view;
      render();
    }

    // Load saved URL and data on startup
    if (state.sheetsUrl) {
      loadFromSheets();
    }

    // Initial render
    render();
  </script>

</body></html>